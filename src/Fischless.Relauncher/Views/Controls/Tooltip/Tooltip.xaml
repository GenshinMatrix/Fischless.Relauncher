<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:Fischless.Relauncher.Views.Controls">
    <!--  Converter registration  -->
    <local:TooltipCenterOffsetConverter x:Key="TooltipCenterOffsetConverter" />
    <Style x:Key="BalloonToolTip" TargetType="ToolTip">
        <!--  Basic properties  -->
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="HasDropShadow" Value="False" />
        <Setter Property="Placement" Value="Bottom" />
        <Setter Property="ToolTipService.ShowDuration" Value="0" />
        <Setter Property="ToolTipService.HorizontalOffset" Value="{Binding ActualWidth, RelativeSource={RelativeSource Self}, Converter={StaticResource TooltipCenterOffsetConverter}}" />
        <Setter Property="ToolTipService.VerticalOffset" Value="4" />
        <Setter Property="ToolTipService.InitialShowDelay" Value="0" />
        <Setter Property="ToolTipService.BetweenShowDelay" Value="0" />
        <Setter Property="ToolTipService.ShowDuration" Value="6000" />
        <Setter Property="ToolTipService.PlacementTarget" Value="{Binding RelativeSource={RelativeSource Self}}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ToolTip">
                    <!--  Root container with scale transform for animation  -->
                    <Grid RenderTransformOrigin="0.5,0">
                        <Grid.RenderTransform>
                            <ScaleTransform x:Name="scale" ScaleX="0.8" ScaleY="0.8" />
                        </Grid.RenderTransform>
                        <StackPanel>
                            <!--  Arrow  -->
                            <Path HorizontalAlignment="Center"
                                  Data="M 0 6 L 6 0 L 12 6 Z"
                                  Fill="#F2F2F2"
                                  Stroke="#CCC"
                                  StrokeThickness="0.5" />
                            <!--  Content box  -->
                            <Border Padding="11,5"
                                    Background="#F2F2F2"
                                    BorderBrush="#CCC"
                                    BorderThickness="0.5"
                                    CornerRadius="4">
                                <TextBlock FontFamily="Microsoft Yahei UI"
                                           FontSize="14"
                                           Foreground="#36373A"
                                           Text="{TemplateBinding Content}" />
                            </Border>
                        </StackPanel>
                    </Grid>
                    <!--  Animation trigger  -->
                    <ControlTemplate.Triggers>
                        <!--  When tooltip opens, play scale + fade animation  -->
                        <EventTrigger RoutedEvent="ToolTip.Opened">
                            <BeginStoryboard>
                                <Storyboard>
                                    <!--  Scale animation  -->
                                    <DoubleAnimation Storyboard.TargetName="scale"
                                                     Storyboard.TargetProperty="ScaleX"
                                                     From="0.8"
                                                     To="1.0"
                                                     Duration="0:0:0.15">
                                        <DoubleAnimation.EasingFunction>
                                            <QuadraticEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                    </DoubleAnimation>
                                    <DoubleAnimation Storyboard.TargetName="scale"
                                                     Storyboard.TargetProperty="ScaleY"
                                                     From="0.8"
                                                     To="1.0"
                                                     Duration="0:0:0.15">
                                        <DoubleAnimation.EasingFunction>
                                            <QuadraticEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                    </DoubleAnimation>
                                    <!--  Fade-in animation  -->
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                     From="0"
                                                     To="1"
                                                     Duration="0:0:0.15" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
